{% extends 'base.html' %}
{% load static %}
{% block title %}Garage | przegląd{% endblock %}

{% block body %}
    {% if bands|length == 0 %}
        <p>Brak zespołów dla zadanych filtrów.</p>
    {% else %}
    <div class="flex-container">
        {% for band in bands %}
        <div class="image-box-overlay">
<!--Band image-->
            <img
                src="/media/{{band.image}}"
                class="band-photo-small"
                style="position: relative;"
                onmouseover="showIcons('icon play {{ band.id }}', 'image glass {{ band.id }}', 'name glass {{ band.id }}', 'description {{ band.id }}')"
                onmouseout="hideIcons('icon play {{ band.id }}', 'image glass {{ band.id }}', 'name glass {{ band.id }}', 'description {{ band.id }}')"
            />
<!--Image glass-->
            <div
                class="image-overlay"
                id="image glass {{ band.id }}"
                onmouseover="showIcons('icon play {{ band.id }}', 'image glass {{ band.id }}', 'name glass {{ band.id }}', 'description {{ band.id }}')"
                onmouseout="hideIcons('icon play {{ band.id }}', 'image glass {{ band.id }}', 'name glass {{ band.id }}', 'description {{ band.id }}')"
            ></div>
<!--Description-->
            <div
                class="description"
                id="description {{ band.id }}"
                onmouseover="showIcons('icon play {{ band.id }}', 'image glass {{ band.id }}', 'name glass {{ band.id }}', 'description {{ band.id }}')"
                onmouseout="hideIcons('icon play {{ band.id }}', 'image glass {{ band.id }}', 'name glass {{ band.id }}', 'description {{ band.id }}')"
            >
                {{ band.short_desc }}
            </div>
<!--Icon play-->
            <i
                class="fa-solid fa-circle-play fa-2xl play-overlay"
                id="icon play {{ band.id }}"
                {% for song in songs %}
                    {% if song.band.id == band.id %}
                        style="cursor: pointer"
                        onclick="play('/media/{{ song.file }}')"
                    {% endif %}
                {% endfor %}
                onmouseover="showIcons('icon play {{ band.id }}', 'image glass {{ band.id }}', 'name glass {{ band.id }}', 'description {{ band.id }}')"
                onmouseout="hideIcons('icon play {{ band.id }}', 'image glass {{ band.id }}', 'name glass {{ band.id }}', 'description {{ band.id }}')"
            ></i>

<!--Band name-->
            <div class="text text-overlay">
                <span
                    class="span-name-overlay"
                    id="name glass {{ band.id }}"
                    onmouseover="showIcons('icon play {{ band.id }}', 'image glass {{ band.id }}', 'name glass {{ band.id }}', 'description {{ band.id }}')"
                    onmouseout="hideIcons('icon play {{ band.id }}', 'image glass {{ band.id }}', 'name glass {{ band.id }}', 'description {{ band.id }}')"
                >
                    {{ band.name }}
                </span>
            </div>
        </div>
        {% endfor %}
    </div>
    {% endif %}




<!--OFFCANVAS-->
<form method="post">
    {% csrf_token %}
    <div class="offcanvas offcanvas-start" data-bs-scroll="true" tabindex="-1" id="filterOffcanvas" aria-labelledby="filterOffcanvasLabel">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="offcanvasWithBothOptionsLabel">Filtracja</h5>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Zamknij"></button>
        </div>

        <input type="text" id="search-place-canvas" name="search-place-canvas" placeholder="Szukaj...">
        <button type="submit" id="btn-offcanvas" name="set_filters" data-bs-dismiss="offcanvas">Szukaj</button>

        <div class="offcanvas-body">
            <div class="row">
    <!--Search-->
                <div class="col">
                    Szukaj:<br>
                    {% for filter_id, filter_name in filters.search_fields.items %}
                        <label class="list-group-item">
                            <input class="form-check-input me-1 search-options" id="searchFields-{{ filter_id }}" type="checkbox" name="searchFields-{{ filter_id }}" value="searchFields-{{ filter_id }}"> {{ filter_name }}
                        </label>
                    {% endfor %}
                </div>
    <!--Sort-->
                <div class="col g-0">
                    Sortuj:<br>
                    {% for filter_id, filter_name in filters.sort_options.items %}
                        <input class="form-check-input sort-options" type="radio" name="sortRadios" id="sortRadios-{{ filter_id }}" value="sortRadios-{{ filter_id }}">
                        <label class="form-check-label" for="sortRadios-{{ filter_id }}"> {{ filter_name }}</label><br>
                    {% endfor %}
                </div>
            </div>
            <br>
    <!--Filter-->
            Filtruj:<br>
            <div class="row">
                <div class="col-3">
                    zespoły
                </div>
                <div class="col">
                    {% for filter_id, filter_name in filters.bands.items %}
                        <button id="filterBandsButton-{{filter_id}}" class="filter-button" type="button" style="margin: 2px; cursor: default;">
                            <input
                                    type="checkbox"
                                    class="filter-options"
                                    id="filterBands-{{filter_id}}"
                                    onclick="checkboxButton(id, 'filterBandsButton-{{filter_id}}')"
                                    name="filterBands-{{filter_id}}"
                                    value="filterBands-{{filter_id}}"
                                    style="display: none;"
                            >
                            <label for="filterBands-{{filter_id}}">{{ filter_name }}</label>
                        </button>
                    {% endfor %}
                </div>
            </div><br>
            <div class="row">
                <div class="col-3">
                    utwory
                </div>
                <div class="col">
                    {% for filter_id, filter_name in filters.songs.items %}
                        <button id="filterSongsButton-{{filter_id}}" class="filter-button" type="button" style="margin: 2px; cursor: default;">
                            <input
                                    type="checkbox"
                                    class="filter-options"
                                    id="filterSongs-{{filter_id}}"
                                    onclick="checkboxButton(id, 'filterSongsButton-{{filter_id}}')"
                                    name="filterSongs-{{filter_id}}"
                                    value="filterSongs-{{filter_id}}"
                                    style="display: none;"
                            >
                            <label for="filterSongs-{{filter_id}}">{{ filter_name }}</label>
                        </button>
                    {% endfor %}
                </div>
            </div><br>
            <div class="row">
                <div class="col-3">
                    gatunki
                </div>
                <div class="col">
                    {% for filter_id, filter_name in filters.genres %}
                        <button id="filterGenresButton-{{filter_id}}" class="filter-button" type="button" style="margin: 2px; cursor: default;">
                            <input
                                    type="checkbox"
                                    class="filter-options"
                                    id="filterGenres-{{filter_id}}"
                                    onclick="checkboxButton(id, 'filterGenresButton-{{filter_id}}')"
                                    name="filterGenres-{{filter_id}}"
                                    value="filterGenres-{{filter_id}}"
                                    style="display: none;"
                            >
                            <label for="filterGenres-{{filter_id}}">{{ filter_name }}</label>
                        </button>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</form>

<script>
    filterBtn = document.getElementById("btn-filter");
    searchBtn = document.getElementById("btn-search");
    searchPlace = document.getElementById("search-place");
    filterBtn.style.display = "inline-block";
    searchBtn.style.display = "inline-block";
    searchPlace.style.display = "inline-block";
</script>

<!--Player-->
<footer class="footer">
    <audio controls seekable controlsList="nodownload" class="player" style="width: 80%; foreground-color: yellow;" id="player">
        <source src="" type="audio/mpeg" id="playerSrc">
        <source src="" type="audio/ogg">
        Your browser does not support the <code>audio</code> element.
    </audio>
</footer>

{% endblock body %}
